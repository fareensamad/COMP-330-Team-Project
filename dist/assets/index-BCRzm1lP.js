(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=i(o);fetch(o.href,a)}})();function G(t,e,i,n){function o(a){return a instanceof i?a:new i(function(c){c(a)})}return new(i||(i=Promise))(function(a,c){function s(l){try{r(n.next(l))}catch(u){c(u)}}function d(l){try{r(n.throw(l))}catch(u){c(u)}}function r(l){l.done?a(l.value):o(l.value).then(s,d)}r((n=n.apply(t,[])).next())})}function Be(t,e,i,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?n:i==="a"?n.call(t):n?n.value:e.get(t)}class p extends Error{constructor(e,i=0,n="",o=""){super(e),this.name="AppwriteException",this.message=e,this.code=i,this.type=n,this.response=o}}class g{constructor(){this.config={endpoint:"https://cloud.appwrite.io/v1",endpointRealtime:"",project:"",jwt:"",locale:"",session:"",devkey:""},this.headers={"x-sdk-name":"Web","x-sdk-platform":"client","x-sdk-language":"web","x-sdk-version":"21.4.0","X-Appwrite-Response-Format":"1.8.0"},this.realtime={socket:void 0,timeout:void 0,heartbeat:void 0,url:"",channels:new Set,subscriptions:new Map,subscriptionsCounter:0,reconnect:!0,reconnectAttempts:0,lastMessage:void 0,connect:()=>{clearTimeout(this.realtime.timeout),this.realtime.timeout=window?.setTimeout(()=>{this.realtime.createSocket()},50)},getTimeout:()=>{switch(!0){case this.realtime.reconnectAttempts<5:return 1e3;case this.realtime.reconnectAttempts<15:return 5e3;case this.realtime.reconnectAttempts<100:return 1e4;default:return 6e4}},createHeartbeat:()=>{this.realtime.heartbeat&&clearTimeout(this.realtime.heartbeat),this.realtime.heartbeat=window?.setInterval(()=>{var e;(e=this.realtime.socket)===null||e===void 0||e.send(JSON.stringify({type:"ping"}))},2e4)},createSocket:()=>{var e,i,n;if(this.realtime.channels.size<1){this.realtime.reconnect=!1,(e=this.realtime.socket)===null||e===void 0||e.close();return}const o=new URLSearchParams;this.config.project&&o.set("project",this.config.project),this.realtime.channels.forEach(c=>{o.append("channels[]",c)});const a=this.config.endpointRealtime+"/realtime?"+o.toString();(a!==this.realtime.url||!this.realtime.socket||((i=this.realtime.socket)===null||i===void 0?void 0:i.readyState)>WebSocket.OPEN)&&(this.realtime.socket&&((n=this.realtime.socket)===null||n===void 0?void 0:n.readyState)<WebSocket.CLOSING&&(this.realtime.reconnect=!1,this.realtime.socket.close()),this.realtime.url=a,this.realtime.socket=new WebSocket(a),this.realtime.socket.addEventListener("message",this.realtime.onMessage),this.realtime.socket.addEventListener("open",c=>{this.realtime.reconnectAttempts=0,this.realtime.createHeartbeat()}),this.realtime.socket.addEventListener("close",c=>{var s,d,r;if(!this.realtime.reconnect||((d=(s=this.realtime)===null||s===void 0?void 0:s.lastMessage)===null||d===void 0?void 0:d.type)==="error"&&((r=this.realtime)===null||r===void 0?void 0:r.lastMessage.data).code===1008){this.realtime.reconnect=!0;return}const l=this.realtime.getTimeout();console.error(`Realtime got disconnected. Reconnect will be attempted in ${l/1e3} seconds.`,c.reason),setTimeout(()=>{this.realtime.reconnectAttempts++,this.realtime.createSocket()},l)}))},onMessage:e=>{var i,n;try{const o=JSON.parse(e.data);switch(this.realtime.lastMessage=o,o.type){case"connected":let a=this.config.session;if(!a){const d=JSON.parse((i=window.localStorage.getItem("cookieFallback"))!==null&&i!==void 0?i:"{}");a=d?.[`a_session_${this.config.project}`]}const c=o.data;a&&!c.user&&((n=this.realtime.socket)===null||n===void 0||n.send(JSON.stringify({type:"authentication",data:{session:a}})));break;case"event":let s=o.data;if(s?.channels){if(!s.channels.some(r=>this.realtime.channels.has(r)))return;this.realtime.subscriptions.forEach(r=>{s.channels.some(l=>r.channels.includes(l))&&setTimeout(()=>r.callback(s))})}break;case"pong":break;case"error":throw o.data;default:break}}catch(o){console.error(o)}},cleanUp:e=>{this.realtime.channels.forEach(i=>{e.includes(i)&&(Array.from(this.realtime.subscriptions).some(([o,a])=>a.channels.includes(i))||this.realtime.channels.delete(i))})}}}setEndpoint(e){if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new p("Invalid endpoint URL: "+e);return this.config.endpoint=e,this.config.endpointRealtime=e.replace("https://","wss://").replace("http://","ws://"),this}setEndpointRealtime(e){if(!e.startsWith("ws://")&&!e.startsWith("wss://"))throw new p("Invalid realtime endpoint URL: "+e);return this.config.endpointRealtime=e,this}setProject(e){return this.headers["X-Appwrite-Project"]=e,this.config.project=e,this}setJWT(e){return this.headers["X-Appwrite-JWT"]=e,this.config.jwt=e,this}setLocale(e){return this.headers["X-Appwrite-Locale"]=e,this.config.locale=e,this}setSession(e){return this.headers["X-Appwrite-Session"]=e,this.config.session=e,this}setDevKey(e){return this.headers["X-Appwrite-Dev-Key"]=e,this.config.devkey=e,this}subscribe(e,i){let n=typeof e=="string"?[e]:e;n.forEach(a=>this.realtime.channels.add(a));const o=this.realtime.subscriptionsCounter++;return this.realtime.subscriptions.set(o,{channels:n,callback:i}),this.realtime.connect(),()=>{this.realtime.subscriptions.delete(o),this.realtime.cleanUp(n),this.realtime.connect()}}prepareRequest(e,i,n={},o={}){if(e=e.toUpperCase(),n=Object.assign({},this.headers,n),typeof window<"u"&&window.localStorage){const c=window.localStorage.getItem("cookieFallback");c&&(n["X-Fallback-Cookies"]=c)}let a={method:e,headers:n};if(n["X-Appwrite-Dev-Key"]===void 0&&(a.credentials="include"),e==="GET")for(const[c,s]of Object.entries(g.flatten(o)))i.searchParams.append(c,s);else switch(n["content-type"]){case"application/json":a.body=JSON.stringify(o);break;case"multipart/form-data":const c=new FormData;for(const[s,d]of Object.entries(o))if(d instanceof File)c.append(s,d,d.name);else if(Array.isArray(d))for(const r of d)c.append(`${s}[]`,r);else c.append(s,d);a.body=c,delete n["content-type"];break}return{uri:i.toString(),options:a}}chunkedUpload(e,i,n={},o={},a){var c;return G(this,void 0,void 0,function*(){const[s,d]=(c=Object.entries(o).find(([u,f])=>f instanceof File))!==null&&c!==void 0?c:[];if(!d||!s)throw new Error("File not found in payload");if(d.size<=g.CHUNK_SIZE)return yield this.call(e,i,n,o);let r=0,l=null;for(;r<d.size;){let u=r+g.CHUNK_SIZE;u>=d.size&&(u=d.size),n["content-range"]=`bytes ${r}-${u-1}/${d.size}`;const f=d.slice(r,u);let m=Object.assign({},o);m[s]=new File([f],d.name),l=yield this.call(e,i,n,m),a&&typeof a=="function"&&a({$id:l.$id,progress:Math.round(u/d.size*100),sizeUploaded:u,chunksTotal:Math.ceil(d.size/g.CHUNK_SIZE),chunksUploaded:Math.ceil(u/g.CHUNK_SIZE)}),l&&l.$id&&(n["x-appwrite-id"]=l.$id),r=u}return l})}ping(){return G(this,void 0,void 0,function*(){return this.call("GET",new URL(this.config.endpoint+"/ping"))})}call(e,i,n={},o={},a="json"){var c,s;return G(this,void 0,void 0,function*(){const{uri:d,options:r}=this.prepareRequest(e,i,n,o);let l=null;const u=yield fetch(d,r);if(u.type==="opaque")throw new p(`Invalid Origin. Register your new client (${window.location.host}) as a new Web platform on your project console dashboard`,403,"forbidden","");const f=u.headers.get("x-appwrite-warning");if(f&&f.split(";").forEach(I=>console.warn("Warning: "+I)),!((c=u.headers.get("content-type"))===null||c===void 0)&&c.includes("application/json")?l=yield u.json():a==="arrayBuffer"?l=yield u.arrayBuffer():l={message:yield u.text()},400<=u.status){let I="";throw!((s=u.headers.get("content-type"))===null||s===void 0)&&s.includes("application/json")||a==="arrayBuffer"?I=JSON.stringify(l):I=l?.message,new p(l?.message,u.status,l?.type,I)}const m=u.headers.get("X-Fallback-Cookies");return typeof window<"u"&&window.localStorage&&m&&(window.console.warn("Appwrite is using localStorage for session management. Increase your security by adding a custom domain as your API endpoint."),window.localStorage.setItem("cookieFallback",m)),l})}static flatten(e,i=""){let n={};for(const[o,a]of Object.entries(e)){let c=i?i+"["+o+"]":o;Array.isArray(a)?n=Object.assign(Object.assign({},n),g.flatten(a,c)):n[c]=a}return n}}g.CHUNK_SIZE=1024*1024*5;class x{constructor(e){this.client=e}static flatten(e,i=""){let n={};for(const[o,a]of Object.entries(e)){let c=i?i+"["+o+"]":o;Array.isArray(a)?n=Object.assign(Object.assign({},n),x.flatten(a,c)):n[c]=a}return n}}x.CHUNK_SIZE=5*1024*1024;class be{constructor(e){this.client=e}get(){const e="/account",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}create(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,email:i[0],password:i[1],name:i[2]};const o=n.userId,a=n.email,c=n.password,s=n.name;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "email"');if(typeof c>"u")throw new p('Missing required parameter: "password"');const d="/account",r={};typeof o<"u"&&(r.userId=o),typeof a<"u"&&(r.email=a),typeof c<"u"&&(r.password=c),typeof s<"u"&&(r.name=s);const l=new URL(this.client.config.endpoint+d),u={"content-type":"application/json"};return this.client.call("post",l,u,r)}updateEmail(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={email:e,password:i[0]};const o=n.email,a=n.password;if(typeof o>"u")throw new p('Missing required parameter: "email"');if(typeof a>"u")throw new p('Missing required parameter: "password"');const c="/account/email",s={};typeof o<"u"&&(s.email=o),typeof a<"u"&&(s.password=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("patch",d,r,s)}listIdentities(e,...i){let n;!e||e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={queries:e,total:i[0]};const o=n.queries,a=n.total,c="/account/identities",s={};typeof o<"u"&&(s.queries=o),typeof a<"u"&&(s.total=a);const d=new URL(this.client.config.endpoint+c),r={};return this.client.call("get",d,r,s)}deleteIdentity(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={identityId:e};const n=i.identityId;if(typeof n>"u")throw new p('Missing required parameter: "identityId"');const o="/account/identities/{identityId}".replace("{identityId}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("delete",c,s,a)}createJWT(){const e="/account/jwts",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("post",n,o,i)}listLogs(e,...i){let n;!e||e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={queries:e,total:i[0]};const o=n.queries,a=n.total,c="/account/logs",s={};typeof o<"u"&&(s.queries=o),typeof a<"u"&&(s.total=a);const d=new URL(this.client.config.endpoint+c),r={};return this.client.call("get",d,r,s)}updateMFA(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={mfa:e};const n=i.mfa;if(typeof n>"u")throw new p('Missing required parameter: "mfa"');const o="/account/mfa",a={};typeof n<"u"&&(a.mfa=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("patch",c,s,a)}createMfaAuthenticator(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?i=e||{}:i={type:e};const n=i.type;if(typeof n>"u")throw new p('Missing required parameter: "type"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}createMFAAuthenticator(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?i=e||{}:i={type:e};const n=i.type;if(typeof n>"u")throw new p('Missing required parameter: "type"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}updateMfaAuthenticator(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?n=e||{}:n={type:e,otp:i[0]};const o=n.type,a=n.otp;if(typeof o>"u")throw new p('Missing required parameter: "type"');if(typeof a>"u")throw new p('Missing required parameter: "otp"');const c="/account/mfa/authenticators/{type}".replace("{type}",o),s={};typeof a<"u"&&(s.otp=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}updateMFAAuthenticator(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?n=e||{}:n={type:e,otp:i[0]};const o=n.type,a=n.otp;if(typeof o>"u")throw new p('Missing required parameter: "type"');if(typeof a>"u")throw new p('Missing required parameter: "otp"');const c="/account/mfa/authenticators/{type}".replace("{type}",o),s={};typeof a<"u"&&(s.otp=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}deleteMfaAuthenticator(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?i=e||{}:i={type:e};const n=i.type;if(typeof n>"u")throw new p('Missing required parameter: "type"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("delete",c,s,a)}deleteMFAAuthenticator(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?i=e||{}:i={type:e};const n=i.type;if(typeof n>"u")throw new p('Missing required parameter: "type"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("delete",c,s,a)}createMfaChallenge(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"factor"in e?i=e||{}:i={factor:e};const n=i.factor;if(typeof n>"u")throw new p('Missing required parameter: "factor"');const o="/account/mfa/challenge",a={};typeof n<"u"&&(a.factor=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}createMFAChallenge(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"factor"in e?i=e||{}:i={factor:e};const n=i.factor;if(typeof n>"u")throw new p('Missing required parameter: "factor"');const o="/account/mfa/challenge",a={};typeof n<"u"&&(a.factor=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}updateMfaChallenge(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={challengeId:e,otp:i[0]};const o=n.challengeId,a=n.otp;if(typeof o>"u")throw new p('Missing required parameter: "challengeId"');if(typeof a>"u")throw new p('Missing required parameter: "otp"');const c="/account/mfa/challenge",s={};typeof o<"u"&&(s.challengeId=o),typeof a<"u"&&(s.otp=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}updateMFAChallenge(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={challengeId:e,otp:i[0]};const o=n.challengeId,a=n.otp;if(typeof o>"u")throw new p('Missing required parameter: "challengeId"');if(typeof a>"u")throw new p('Missing required parameter: "otp"');const c="/account/mfa/challenge",s={};typeof o<"u"&&(s.challengeId=o),typeof a<"u"&&(s.otp=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}listMfaFactors(){const e="/account/mfa/factors",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}listMFAFactors(){const e="/account/mfa/factors",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}getMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}getMFARecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}createMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("post",n,o,i)}createMFARecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("post",n,o,i)}updateMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("patch",n,o,i)}updateMFARecoveryCodes(){const e="/account/mfa/recovery-codes",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("patch",n,o,i)}updateName(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={name:e};const n=i.name;if(typeof n>"u")throw new p('Missing required parameter: "name"');const o="/account/name",a={};typeof n<"u"&&(a.name=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("patch",c,s,a)}updatePassword(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={password:e,oldPassword:i[0]};const o=n.password,a=n.oldPassword;if(typeof o>"u")throw new p('Missing required parameter: "password"');const c="/account/password",s={};typeof o<"u"&&(s.password=o),typeof a<"u"&&(s.oldPassword=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("patch",d,r,s)}updatePhone(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={phone:e,password:i[0]};const o=n.phone,a=n.password;if(typeof o>"u")throw new p('Missing required parameter: "phone"');if(typeof a>"u")throw new p('Missing required parameter: "password"');const c="/account/phone",s={};typeof o<"u"&&(s.phone=o),typeof a<"u"&&(s.password=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("patch",d,r,s)}getPrefs(){const e="/account/prefs",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}updatePrefs(e){let i;e&&typeof e=="object"&&!Array.isArray(e)&&"prefs"in e?i=e||{}:i={prefs:e};const n=i.prefs;if(typeof n>"u")throw new p('Missing required parameter: "prefs"');const o="/account/prefs",a={};typeof n<"u"&&(a.prefs=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("patch",c,s,a)}createRecovery(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={email:e,url:i[0]};const o=n.email,a=n.url;if(typeof o>"u")throw new p('Missing required parameter: "email"');if(typeof a>"u")throw new p('Missing required parameter: "url"');const c="/account/recovery",s={};typeof o<"u"&&(s.email=o),typeof a<"u"&&(s.url=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("post",d,r,s)}updateRecovery(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0],password:i[1]};const o=n.userId,a=n.secret,c=n.password;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');if(typeof c>"u")throw new p('Missing required parameter: "password"');const s="/account/recovery",d={};typeof o<"u"&&(d.userId=o),typeof a<"u"&&(d.secret=a),typeof c<"u"&&(d.password=c);const r=new URL(this.client.config.endpoint+s),l={"content-type":"application/json"};return this.client.call("put",r,l,d)}listSessions(){const e="/account/sessions",i={},n=new URL(this.client.config.endpoint+e),o={};return this.client.call("get",n,o,i)}deleteSessions(){const e="/account/sessions",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("delete",n,o,i)}createAnonymousSession(){const e="/account/sessions/anonymous",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("post",n,o,i)}createEmailPasswordSession(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={email:e,password:i[0]};const o=n.email,a=n.password;if(typeof o>"u")throw new p('Missing required parameter: "email"');if(typeof a>"u")throw new p('Missing required parameter: "password"');const c="/account/sessions/email",s={};typeof o<"u"&&(s.email=o),typeof a<"u"&&(s.password=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("post",d,r,s)}updateMagicURLSession(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/sessions/magic-url",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}createOAuth2Session(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)&&"provider"in e?n=e||{}:n={provider:e,success:i[0],failure:i[1],scopes:i[2]};const o=n.provider,a=n.success,c=n.failure,s=n.scopes;if(typeof o>"u")throw new p('Missing required parameter: "provider"');const d="/account/sessions/oauth2/{provider}".replace("{provider}",o),r={};typeof a<"u"&&(r.success=a),typeof c<"u"&&(r.failure=c),typeof s<"u"&&(r.scopes=s);const l=new URL(this.client.config.endpoint+d);r.project=this.client.config.project;for(const[u,f]of Object.entries(x.flatten(r)))l.searchParams.append(u,f);if(typeof window<"u"&&window?.location){window.location.href=l.toString();return}else return l.toString()}updatePhoneSession(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/sessions/phone",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}createSession(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/sessions/token",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("post",d,r,s)}getSession(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={sessionId:e};const n=i.sessionId;if(typeof n>"u")throw new p('Missing required parameter: "sessionId"');const o="/account/sessions/{sessionId}".replace("{sessionId}",n),a={},c=new URL(this.client.config.endpoint+o),s={};return this.client.call("get",c,s,a)}updateSession(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={sessionId:e};const n=i.sessionId;if(typeof n>"u")throw new p('Missing required parameter: "sessionId"');const o="/account/sessions/{sessionId}".replace("{sessionId}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("patch",c,s,a)}deleteSession(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={sessionId:e};const n=i.sessionId;if(typeof n>"u")throw new p('Missing required parameter: "sessionId"');const o="/account/sessions/{sessionId}".replace("{sessionId}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("delete",c,s,a)}updateStatus(){const e="/account/status",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("patch",n,o,i)}createPushTarget(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={targetId:e,identifier:i[0],providerId:i[1]};const o=n.targetId,a=n.identifier,c=n.providerId;if(typeof o>"u")throw new p('Missing required parameter: "targetId"');if(typeof a>"u")throw new p('Missing required parameter: "identifier"');const s="/account/targets/push",d={};typeof o<"u"&&(d.targetId=o),typeof a<"u"&&(d.identifier=a),typeof c<"u"&&(d.providerId=c);const r=new URL(this.client.config.endpoint+s),l={"content-type":"application/json"};return this.client.call("post",r,l,d)}updatePushTarget(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={targetId:e,identifier:i[0]};const o=n.targetId,a=n.identifier;if(typeof o>"u")throw new p('Missing required parameter: "targetId"');if(typeof a>"u")throw new p('Missing required parameter: "identifier"');const c="/account/targets/{targetId}/push".replace("{targetId}",o),s={};typeof a<"u"&&(s.identifier=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}deletePushTarget(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={targetId:e};const n=i.targetId;if(typeof n>"u")throw new p('Missing required parameter: "targetId"');const o="/account/targets/{targetId}/push".replace("{targetId}",n),a={},c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("delete",c,s,a)}createEmailToken(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,email:i[0],phrase:i[1]};const o=n.userId,a=n.email,c=n.phrase;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "email"');const s="/account/tokens/email",d={};typeof o<"u"&&(d.userId=o),typeof a<"u"&&(d.email=a),typeof c<"u"&&(d.phrase=c);const r=new URL(this.client.config.endpoint+s),l={"content-type":"application/json"};return this.client.call("post",r,l,d)}createMagicURLToken(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,email:i[0],url:i[1],phrase:i[2]};const o=n.userId,a=n.email,c=n.url,s=n.phrase;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "email"');const d="/account/tokens/magic-url",r={};typeof o<"u"&&(r.userId=o),typeof a<"u"&&(r.email=a),typeof c<"u"&&(r.url=c),typeof s<"u"&&(r.phrase=s);const l=new URL(this.client.config.endpoint+d),u={"content-type":"application/json"};return this.client.call("post",l,u,r)}createOAuth2Token(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)&&"provider"in e?n=e||{}:n={provider:e,success:i[0],failure:i[1],scopes:i[2]};const o=n.provider,a=n.success,c=n.failure,s=n.scopes;if(typeof o>"u")throw new p('Missing required parameter: "provider"');const d="/account/tokens/oauth2/{provider}".replace("{provider}",o),r={};typeof a<"u"&&(r.success=a),typeof c<"u"&&(r.failure=c),typeof s<"u"&&(r.scopes=s);const l=new URL(this.client.config.endpoint+d);r.project=this.client.config.project;for(const[u,f]of Object.entries(x.flatten(r)))l.searchParams.append(u,f);if(typeof window<"u"&&window?.location){window.location.href=l.toString();return}else return l.toString()}createPhoneToken(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,phone:i[0]};const o=n.userId,a=n.phone;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "phone"');const c="/account/tokens/phone",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.phone=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("post",d,r,s)}createEmailVerification(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={url:e};const n=i.url;if(typeof n>"u")throw new p('Missing required parameter: "url"');const o="/account/verifications/email",a={};typeof n<"u"&&(a.url=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}createVerification(e){let i;e&&typeof e=="object"&&!Array.isArray(e)?i=e||{}:i={url:e};const n=i.url;if(typeof n>"u")throw new p('Missing required parameter: "url"');const o="/account/verifications/email",a={};typeof n<"u"&&(a.url=n);const c=new URL(this.client.config.endpoint+o),s={"content-type":"application/json"};return this.client.call("post",c,s,a)}updateEmailVerification(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/verifications/email",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}updateVerification(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/verifications/email",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}createPhoneVerification(){const e="/account/verifications/phone",i={},n=new URL(this.client.config.endpoint+e),o={"content-type":"application/json"};return this.client.call("post",n,o,i)}updatePhoneVerification(e,...i){let n;e&&typeof e=="object"&&!Array.isArray(e)?n=e||{}:n={userId:e,secret:i[0]};const o=n.userId,a=n.secret;if(typeof o>"u")throw new p('Missing required parameter: "userId"');if(typeof a>"u")throw new p('Missing required parameter: "secret"');const c="/account/verifications/phone",s={};typeof o<"u"&&(s.userId=o),typeof a<"u"&&(s.secret=a);const d=new URL(this.client.config.endpoint+c),r={"content-type":"application/json"};return this.client.call("put",d,r,s)}}var te;(function(t){t[t.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",t[t.POLICY_VIOLATION=1008]="POLICY_VIOLATION",t[t.UNKNOWN_ERROR=-1]="UNKNOWN_ERROR"})(te||(te={}));var Ee,Se;class R{static custom(e){return e}static unique(e=7){const i=Be(R,Ee,"m",Se).call(R);let n="";for(let o=0;o<e;o++){const a=Math.floor(Math.random()*16).toString(16);n+=a}return i+n}}Ee=R,Se=function(){const e=new Date,i=Math.floor(e.getTime()/1e3),n=e.getMilliseconds();return i.toString(16)+n.toString(16).padStart(5,"0")};var ne;(function(t){t.Equal="equal",t.NotEqual="notEqual",t.GreaterThan="greaterThan",t.GreaterThanEqual="greaterThanEqual",t.LessThan="lessThan",t.LessThanEqual="lessThanEqual",t.Contains="contains",t.IsNull="isNull",t.IsNotNull="isNotNull"})(ne||(ne={}));var ie;(function(t){t.Totp="totp"})(ie||(ie={}));var oe;(function(t){t.Email="email",t.Phone="phone",t.Totp="totp",t.Recoverycode="recoverycode"})(oe||(oe={}));var ae;(function(t){t.Amazon="amazon",t.Apple="apple",t.Auth0="auth0",t.Authentik="authentik",t.Autodesk="autodesk",t.Bitbucket="bitbucket",t.Bitly="bitly",t.Box="box",t.Dailymotion="dailymotion",t.Discord="discord",t.Disqus="disqus",t.Dropbox="dropbox",t.Etsy="etsy",t.Facebook="facebook",t.Figma="figma",t.Github="github",t.Gitlab="gitlab",t.Google="google",t.Linkedin="linkedin",t.Microsoft="microsoft",t.Notion="notion",t.Oidc="oidc",t.Okta="okta",t.Paypal="paypal",t.PaypalSandbox="paypalSandbox",t.Podio="podio",t.Salesforce="salesforce",t.Slack="slack",t.Spotify="spotify",t.Stripe="stripe",t.Tradeshift="tradeshift",t.TradeshiftBox="tradeshiftBox",t.Twitch="twitch",t.Wordpress="wordpress",t.Yahoo="yahoo",t.Yammer="yammer",t.Yandex="yandex",t.Zoho="zoho",t.Zoom="zoom",t.Mock="mock"})(ae||(ae={}));var se;(function(t){t.AvantBrowser="aa",t.AndroidWebViewBeta="an",t.GoogleChrome="ch",t.GoogleChromeIOS="ci",t.GoogleChromeMobile="cm",t.Chromium="cr",t.MozillaFirefox="ff",t.Safari="sf",t.MobileSafari="mf",t.MicrosoftEdge="ps",t.MicrosoftEdgeIOS="oi",t.OperaMini="om",t.Opera="op",t.OperaNext="on"})(se||(se={}));var ce;(function(t){t.AmericanExpress="amex",t.Argencard="argencard",t.Cabal="cabal",t.Cencosud="cencosud",t.DinersClub="diners",t.Discover="discover",t.Elo="elo",t.Hipercard="hipercard",t.JCB="jcb",t.Mastercard="mastercard",t.Naranja="naranja",t.TarjetaShopping="targeta-shopping",t.UnionPay="unionpay",t.Visa="visa",t.MIR="mir",t.Maestro="maestro",t.Rupay="rupay"})(ce||(ce={}));var re;(function(t){t.Afghanistan="af",t.Angola="ao",t.Albania="al",t.Andorra="ad",t.UnitedArabEmirates="ae",t.Argentina="ar",t.Armenia="am",t.AntiguaAndBarbuda="ag",t.Australia="au",t.Austria="at",t.Azerbaijan="az",t.Burundi="bi",t.Belgium="be",t.Benin="bj",t.BurkinaFaso="bf",t.Bangladesh="bd",t.Bulgaria="bg",t.Bahrain="bh",t.Bahamas="bs",t.BosniaAndHerzegovina="ba",t.Belarus="by",t.Belize="bz",t.Bolivia="bo",t.Brazil="br",t.Barbados="bb",t.BruneiDarussalam="bn",t.Bhutan="bt",t.Botswana="bw",t.CentralAfricanRepublic="cf",t.Canada="ca",t.Switzerland="ch",t.Chile="cl",t.China="cn",t.CoteDIvoire="ci",t.Cameroon="cm",t.DemocraticRepublicOfTheCongo="cd",t.RepublicOfTheCongo="cg",t.Colombia="co",t.Comoros="km",t.CapeVerde="cv",t.CostaRica="cr",t.Cuba="cu",t.Cyprus="cy",t.CzechRepublic="cz",t.Germany="de",t.Djibouti="dj",t.Dominica="dm",t.Denmark="dk",t.DominicanRepublic="do",t.Algeria="dz",t.Ecuador="ec",t.Egypt="eg",t.Eritrea="er",t.Spain="es",t.Estonia="ee",t.Ethiopia="et",t.Finland="fi",t.Fiji="fj",t.France="fr",t.MicronesiaFederatedStatesOf="fm",t.Gabon="ga",t.UnitedKingdom="gb",t.Georgia="ge",t.Ghana="gh",t.Guinea="gn",t.Gambia="gm",t.GuineaBissau="gw",t.EquatorialGuinea="gq",t.Greece="gr",t.Grenada="gd",t.Guatemala="gt",t.Guyana="gy",t.Honduras="hn",t.Croatia="hr",t.Haiti="ht",t.Hungary="hu",t.Indonesia="id",t.India="in",t.Ireland="ie",t.IranIslamicRepublicOf="ir",t.Iraq="iq",t.Iceland="is",t.Israel="il",t.Italy="it",t.Jamaica="jm",t.Jordan="jo",t.Japan="jp",t.Kazakhstan="kz",t.Kenya="ke",t.Kyrgyzstan="kg",t.Cambodia="kh",t.Kiribati="ki",t.SaintKittsAndNevis="kn",t.SouthKorea="kr",t.Kuwait="kw",t.LaoPeopleSDemocraticRepublic="la",t.Lebanon="lb",t.Liberia="lr",t.Libya="ly",t.SaintLucia="lc",t.Liechtenstein="li",t.SriLanka="lk",t.Lesotho="ls",t.Lithuania="lt",t.Luxembourg="lu",t.Latvia="lv",t.Morocco="ma",t.Monaco="mc",t.Moldova="md",t.Madagascar="mg",t.Maldives="mv",t.Mexico="mx",t.MarshallIslands="mh",t.NorthMacedonia="mk",t.Mali="ml",t.Malta="mt",t.Myanmar="mm",t.Montenegro="me",t.Mongolia="mn",t.Mozambique="mz",t.Mauritania="mr",t.Mauritius="mu",t.Malawi="mw",t.Malaysia="my",t.Namibia="na",t.Niger="ne",t.Nigeria="ng",t.Nicaragua="ni",t.Netherlands="nl",t.Norway="no",t.Nepal="np",t.Nauru="nr",t.NewZealand="nz",t.Oman="om",t.Pakistan="pk",t.Panama="pa",t.Peru="pe",t.Philippines="ph",t.Palau="pw",t.PapuaNewGuinea="pg",t.Poland="pl",t.FrenchPolynesia="pf",t.NorthKorea="kp",t.Portugal="pt",t.Paraguay="py",t.Qatar="qa",t.Romania="ro",t.Russia="ru",t.Rwanda="rw",t.SaudiArabia="sa",t.Sudan="sd",t.Senegal="sn",t.Singapore="sg",t.SolomonIslands="sb",t.SierraLeone="sl",t.ElSalvador="sv",t.SanMarino="sm",t.Somalia="so",t.Serbia="rs",t.SouthSudan="ss",t.SaoTomeAndPrincipe="st",t.Suriname="sr",t.Slovakia="sk",t.Slovenia="si",t.Sweden="se",t.Eswatini="sz",t.Seychelles="sc",t.Syria="sy",t.Chad="td",t.Togo="tg",t.Thailand="th",t.Tajikistan="tj",t.Turkmenistan="tm",t.TimorLeste="tl",t.Tonga="to",t.TrinidadAndTobago="tt",t.Tunisia="tn",t.Turkey="tr",t.Tuvalu="tv",t.Tanzania="tz",t.Uganda="ug",t.Ukraine="ua",t.Uruguay="uy",t.UnitedStates="us",t.Uzbekistan="uz",t.VaticanCity="va",t.SaintVincentAndTheGrenadines="vc",t.Venezuela="ve",t.Vietnam="vn",t.Vanuatu="vu",t.Samoa="ws",t.Yemen="ye",t.SouthAfrica="za",t.Zambia="zm",t.Zimbabwe="zw"})(re||(re={}));var de;(function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.PATCH="PATCH",t.DELETE="DELETE",t.OPTIONS="OPTIONS",t.HEAD="HEAD"})(de||(de={}));var le;(function(t){t.Center="center",t.Topleft="top-left",t.Top="top",t.Topright="top-right",t.Left="left",t.Right="right",t.Bottomleft="bottom-left",t.Bottom="bottom",t.Bottomright="bottom-right"})(le||(le={}));var pe;(function(t){t.Jpg="jpg",t.Jpeg="jpeg",t.Png="png",t.Webp="webp",t.Heic="heic",t.Avif="avif",t.Gif="gif"})(pe||(pe={}));var ue;(function(t){t.Http="http",t.Schedule="schedule",t.Event="event"})(ue||(ue={}));var fe;(function(t){t.Waiting="waiting",t.Processing="processing",t.Completed="completed",t.Failed="failed",t.Scheduled="scheduled"})(fe||(fe={}));const Ue=new g().setEndpoint(void 0).setProject(void 0),qe=new be(Ue);async function Pe(){try{const t=await qe.get();console.log("Appwrite connected. Current user:",t)}catch(t){console.error("Appwrite ping failed:",t)}}Pe();const E="top5Albums",S="top5Songs",ye=document.getElementById("albumsList"),T=document.getElementById("profilePreview"),he=document.getElementById("songsList"),N=document.getElementById("songsPreview"),_="profileImage",me=document.getElementById("avatarInput"),v=document.getElementById("avatarPreviewImg"),X="reviews";let B=null,j=0;function xe(t,e={}){const i=document.createElement("div");i.className="album-row";const n=document.createElement("div"),o=document.createElement("label");o.textContent=`Album ${t+1} title`;const a=document.createElement("input");a.type="text",a.name=`title-${t}`,a.value=e.title||"",n.appendChild(o),n.appendChild(a);const c=document.createElement("div"),s=document.createElement("label");s.textContent="Artist";const d=document.createElement("input");d.type="text",d.name=`artist-${t}`,d.value=e.artist||"",c.appendChild(s),c.appendChild(d);const r=document.createElement("div"),l=document.createElement("button");return l.type="button",l.className="btn",l.textContent="Clear",l.addEventListener("click",()=>{a.value="",d.value=""}),r.appendChild(l),i.appendChild(n),i.appendChild(c),i.appendChild(r),i}function U(){ye.innerHTML="";for(let t=0;t<5;t++)ye.appendChild(xe(t))}function Ce(t,e={}){const i=document.createElement("div");i.className="album-row";const n=document.createElement("div"),o=document.createElement("label");o.textContent=`Song ${t+1} title`;const a=document.createElement("input");a.type="text",a.name=`song-title-${t}`,a.value=e.title||"",n.appendChild(o),n.appendChild(a);const c=document.createElement("div"),s=document.createElement("label");s.textContent="Artist";const d=document.createElement("input");d.type="text",d.name=`song-artist-${t}`,d.value=e.artist||"",c.appendChild(s),c.appendChild(d);const r=document.createElement("div"),l=document.createElement("button");return l.type="button",l.className="btn",l.textContent="Clear",l.addEventListener("click",()=>{a.value="",d.value=""}),r.appendChild(l),i.appendChild(n),i.appendChild(c),i.appendChild(r),i}function q(){he.innerHTML="";for(let t=0;t<5;t++)he.appendChild(Ce(t))}function He(){const t=[];for(let e=0;e<5;e++){const i=(document.querySelector(`[name=title-${e}]`)?.value||"").trim(),n=(document.querySelector(`[name=artist-${e}]`)?.value||"").trim();t.push({title:i,artist:n})}return t}function De(){const t=[];for(let e=0;e<5;e++){const i=(document.querySelector(`[name=song-title-${e}]`)?.value||"").trim(),n=(document.querySelector(`[name=song-artist-${e}]`)?.value||"").trim();t.push({title:i,artist:n})}return t}function ze(){const t=He();if(!t.some(e=>e.title||e.artist)){alert("Please enter at least one album or artist.");return}localStorage.setItem(E,JSON.stringify(t)),$();try{C()}catch{}alert("Profile saved locally.")}function _e(){const t=De();if(!t.some(e=>e.title||e.artist)){alert("Please enter at least one song or artist.");return}localStorage.setItem(S,JSON.stringify(t)),J();try{C()}catch{}alert("Songs saved locally.")}function $e(){confirm("Clear saved profile and form?")&&(localStorage.removeItem(E),U(),$())}function Je(){confirm("Clear saved songs and form?")&&(localStorage.removeItem(S),q(),J())}function $(){const t=localStorage.getItem(E);if(T.innerHTML="",!t){T.innerHTML='<p class="empty">No profile saved yet.</p>';return}let e;try{e=JSON.parse(t)}catch{T.innerHTML='<p class="empty">Bad saved data</p>';return}if(!Array.isArray(e)||e.length===0){T.innerHTML='<p class="empty">No profile saved yet.</p>';return}e.forEach((i,n)=>{const o=document.createElement("div");o.className="item";const a=document.createElement("div");a.className="idx",a.textContent=`${n+1}.`;const c=document.createElement("div"),s=document.createElement("div");s.className="title",s.textContent=i.title||"(untitled)";const d=document.createElement("div");d.className="artist",d.textContent=i.artist?`by ${i.artist}`:"",c.appendChild(s),c.appendChild(d),o.appendChild(a),o.appendChild(c),T.appendChild(o)})}function J(){const t=localStorage.getItem(S);if(N.innerHTML="",!t){N.innerHTML='<p class="empty">No songs saved yet.</p>';return}let e;try{e=JSON.parse(t)}catch{N.innerHTML='<p class="empty">Bad saved data</p>';return}if(!Array.isArray(e)||e.length===0){N.innerHTML='<p class="empty">No songs saved yet.</p>';return}e.forEach((i,n)=>{const o=document.createElement("div");o.className="item";const a=document.createElement("div");a.className="idx",a.textContent=`${n+1}.`;const c=document.createElement("div"),s=document.createElement("div");s.className="title",s.textContent=i.title||"(untitled)";const d=document.createElement("div");d.className="artist",d.textContent=i.artist?`by ${i.artist}`:"",c.appendChild(s),c.appendChild(d),o.appendChild(a),o.appendChild(c),N.appendChild(o)})}function Ae(t,e){if(!t)return e&&e(new Error("No file"));const i=2*1024*1024;if(t.size>i)return e&&e(new Error("File too large (max 2MB)"));const n=new FileReader;n.onload=o=>e&&e(null,o.target.result),n.onerror=o=>e&&e(new Error("Failed reading file")),n.readAsDataURL(t)}function Le(t){t&&(localStorage.setItem(_,t),Q())}function Ke(){localStorage.removeItem(_),Q()}function Q(){const t=localStorage.getItem(_);if(!t){v.style.display="none";const i=v.parentElement.querySelector(".avatar-empty");i&&(i.style.display="block");return}v.src=t,v.style.display="block";const e=v.parentElement.querySelector(".avatar-empty");e&&(e.style.display="none")}function We(){const t=localStorage.getItem(_);if(!t){alert("No avatar to export");return}fetch(t).then(e=>e.blob()).then(e=>{const i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download="profile-image.png",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(i)}).catch(()=>alert("Export failed"))}function Ge(t){Ae(t,(e,i)=>{if(e){alert("Import failed: "+e.message);return}Le(i),alert("Imported avatar.")})}function Ve(){const t=localStorage.getItem(E)||"[]",e=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download="top4Albums.json",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(i)}function Ze(t){const e=new FileReader;e.onload=i=>{try{const n=JSON.parse(i.target.result);if(!Array.isArray(n))throw new Error("JSON must be an array");localStorage.setItem(E,JSON.stringify(n.slice(0,4))),Re(),$(),alert("Imported profile successfully.")}catch(n){alert("Import failed: "+n.message)}},e.readAsText(t)}function Re(){const t=localStorage.getItem(E);if(!t){U();return}let e;try{e=JSON.parse(t)}catch{U();return}U(),e=e||[];for(let i=0;i<4;i++){const n=document.querySelector(`[name=title-${i}]`),o=document.querySelector(`[name=artist-${i}]`);n&&(n.value=e[i]&&e[i].title?e[i].title:""),o&&(o.value=e[i]&&e[i].artist?e[i].artist:"")}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("saveBtn"),e=document.getElementById("clearBtn"),i=document.getElementById("exportBtn"),n=document.getElementById("importInput"),o=document.getElementById("saveSongsBtn"),a=document.getElementById("clearSongsBtn"),c=document.getElementById("exportSongsBtn"),s=document.getElementById("importSongsInput"),d=document.getElementById("saveAvatarBtn"),r=document.getElementById("removeAvatarBtn"),l=document.getElementById("exportAvatarBtn"),u=document.getElementById("importAvatarInput");U(),Re(),$(),q(),Z(),J(),Z(),me&&me.addEventListener("change",y=>{const h=y.target.files&&y.target.files[0];h&&Ae(h,(k,A)=>{k?alert(k.message):v.src=A}),y.target.value=null}),d&&d.addEventListener("click",()=>{v&&v.src?Le(v.src):alert("Please choose an image first.")}),r&&r.addEventListener("click",Ke),l&&l.addEventListener("click",We),u&&u.addEventListener("change",y=>{const h=y.target.files&&y.target.files[0];h&&Ge(h),y.target.value=null}),Q(),t.addEventListener("click",ze),e.addEventListener("click",$e),i.addEventListener("click",Ve),n.addEventListener("change",y=>{const h=y.target.files&&y.target.files[0];h&&Ze(h),y.target.value=null}),o.addEventListener("click",_e),a.addEventListener("click",Je),c.addEventListener("click",()=>{const y=localStorage.getItem(S)||"[]",h=new Blob([y],{type:"application/json"}),k=URL.createObjectURL(h),A=document.createElement("a");A.href=k,A.download="top5Songs.json",document.body.appendChild(A),A.click(),A.remove(),URL.revokeObjectURL(k)}),s.addEventListener("change",y=>{const h=y.target.files&&y.target.files[0];h&&Ye(h),y.target.value=null});const f=document.getElementById("reviewTargetType"),m=document.getElementById("addReviewBtn"),I=document.getElementById("clearReviewFormBtn"),F=document.getElementById("exportReviewsBtn"),ee=document.getElementById("importReviewsInput");f&&f.addEventListener("change",C),je(),C(),W(),m&&m.addEventListener("click",Xe),I&&I.addEventListener("click",Me),F&&F.addEventListener("click",Fe),ee&&ee.addEventListener("change",y=>{const h=y.target.files&&y.target.files[0];h&&et(h),y.target.value=null})});function Z(){const t=localStorage.getItem(S);if(!t){q();return}let e;try{e=JSON.parse(t)}catch{q();return}q(),e=e||[];for(let i=0;i<5;i++){const n=document.querySelector(`[name=song-title-${i}]`),o=document.querySelector(`[name=song-artist-${i}]`);n&&(n.value=e[i]&&e[i].title?e[i].title:""),o&&(o.value=e[i]&&e[i].artist?e[i].artist:"")}}function Ye(t){const e=new FileReader;e.onload=i=>{try{const n=JSON.parse(i.target.result);if(!Array.isArray(n))throw new Error("JSON must be an array");localStorage.setItem(S,JSON.stringify(n.slice(0,5))),Z(),J(),alert("Imported songs successfully.")}catch(n){alert("Import failed: "+n.message)}},e.readAsText(t)}function K(){try{return JSON.parse(localStorage.getItem(X)||"[]")}catch{return[]}}function O(t){localStorage.setItem(X,JSON.stringify(t))}function C(){const t=document.getElementById("reviewTargetName"),e=document.getElementById("reviewTargetArtist");!t||!e||(t.value="",e.value="")}function je(){const t=document.getElementById("reviewRating");if(t){t.innerHTML="",j=0;for(let e=1;e<=5;e++){const i=document.createElement("span");i.className="star",i.textContent="★",i.dataset.value=e,i.addEventListener("click",()=>{j=e,[...t.querySelectorAll(".star")].forEach(n=>n.classList.toggle("filled",Number(n.dataset.value)<=e))}),t.appendChild(i)}}}function Me(){B=null,j=0;const t=document.getElementById("reviewTargetType"),e=document.getElementById("reviewText");t&&(t.value="album"),e&&(e.value="");const i=document.getElementById("reviewTargetName"),n=document.getElementById("reviewTargetArtist");i&&(i.value=""),n&&(n.value=""),je();const o=document.getElementById("addReviewBtn");o&&(o.textContent="Add Review"),C()}function Xe(){const t=document.getElementById("reviewTargetType"),e=document.getElementById("reviewTargetName"),i=document.getElementById("reviewTargetArtist"),n=document.getElementById("reviewText");if(!t||!e||!i||!n)return;const o=t.value,a=(e.value||"").trim(),c=(i.value||"").trim(),s=n.value.trim(),d=Number(j||0);if(!a){alert("Please enter the album or song title.");return}if(!s&&d===0){alert("Please add a rating or some review text.");return}const r=K();if(B){const l=r.findIndex(u=>u.id===B);l>=0&&(r[l].targetType=o,r[l].targetName=a,r[l].targetArtist=c,r[l].rating=d,r[l].text=s,r[l].updatedAt=new Date().toISOString(),"targetIndex"in r[l]&&delete r[l].targetIndex),B=null}else{const l={id:Date.now().toString(),targetType:o,targetName:a,targetArtist:c,rating:d,text:s,createdAt:new Date().toISOString()};r.unshift(l)}O(r),W(),Me()}function W(){const t=document.getElementById("reviewsList");if(!t)return;const e=K();if(t.innerHTML="",!e||e.length===0){t.innerHTML='<p class="empty">No reviews yet.</p>';return}e.forEach(i=>{const n=document.createElement("div");n.className="review-item";const o=document.createElement("div");o.className="meta";const a=document.createElement("div");a.className="target";let c="(unknown)";if(i.targetName)c=i.targetName+(i.targetArtist?` — ${i.targetArtist}`:"");else if(typeof i.targetIndex=="number")if(i.targetType==="album")try{const f=JSON.parse(localStorage.getItem(E)||"[]");f[i.targetIndex]&&(c=`${i.targetIndex+1}. ${f[i.targetIndex].title||"(untitled)"}`)}catch{}else try{const f=JSON.parse(localStorage.getItem(S)||"[]");f[i.targetIndex]&&(c=`${i.targetIndex+1}. ${f[i.targetIndex].title||"(untitled)"}`)}catch{}a.textContent=`${i.targetType==="album"?"Album":"Song"} — ${c}`,o.appendChild(a);const s=document.createElement("div");s.className="rating";for(let f=1;f<=5;f++){const m=document.createElement("span");m.className="star"+((i.rating||0)>=f?" filled":""),m.textContent="★",s.appendChild(m)}o.appendChild(s);const d=document.createElement("div");d.className="review-text",d.textContent=i.text||"",o.appendChild(d);const r=document.createElement("div");r.className="review-controls";const l=document.createElement("button");l.className="btn",l.textContent="Edit",l.addEventListener("click",()=>Qe(i.id));const u=document.createElement("button");u.className="btn",u.textContent="Delete",u.addEventListener("click",()=>{confirm("Delete this review?")&&Oe(i.id)}),r.appendChild(l),r.appendChild(u),n.appendChild(o),n.appendChild(r),t.appendChild(n)})}function Qe(t){const i=K().find(r=>r.id===t);if(!i)return;B=t;const n=document.getElementById("reviewTargetType"),o=document.getElementById("reviewTargetName"),a=document.getElementById("reviewTargetArtist"),c=document.getElementById("reviewText");if(n&&(n.value=i.targetType),o&&a){if(i.targetName)o.value=i.targetName,a.value=i.targetArtist||"";else if(typeof i.targetIndex=="number")if(i.targetType==="album")try{const r=JSON.parse(localStorage.getItem(E)||"[]");r[i.targetIndex]&&(o.value=r[i.targetIndex].title||"",a.value=r[i.targetIndex].artist||"")}catch{}else try{const r=JSON.parse(localStorage.getItem(S)||"[]");r[i.targetIndex]&&(o.value=r[i.targetIndex].title||"",a.value=r[i.targetIndex].artist||"")}catch{}}c&&(c.value=i.text||""),j=Number(i.rating||0);const s=document.getElementById("reviewRating");s&&[...s.querySelectorAll(".star")].forEach(r=>r.classList.toggle("filled",Number(r.dataset.value)<=j));const d=document.getElementById("addReviewBtn");d&&(d.textContent="Save Review")}function Oe(t){const e=K().filter(i=>i.id!==t);O(e),W()}function Fe(){const t=localStorage.getItem(X)||"[]",e=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download="reviews.json",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(i)}function et(t){const e=new FileReader;e.onload=i=>{try{const n=JSON.parse(i.target.result);if(!Array.isArray(n))throw new Error("JSON must be an array");O(n),W(),alert("Imported reviews")}catch(n){alert("Import failed: "+n.message)}},e.readAsText(t)}const ke=void 0,tt=void 0,nt=new g,w=new be(nt),D=document.getElementById("authSection"),z=document.getElementById("appMain"),M=document.getElementById("logoutBtn"),we=document.getElementById("authForm"),it=document.getElementById("authEmail"),ot=document.getElementById("authPassword"),P=document.getElementById("authSubmit"),H=document.getElementById("toggleAuthMode"),ge=document.getElementById("authHint"),V=document.getElementById("authError");let b=!1;function at(){return!!ke}function ve(t){P&&(P.disabled=t,P.textContent=t?b?"Creating...":"Signing in...":b?"Create account":"Sign in")}function L(t){V&&(V.textContent=t||"",V.style.display=t?"block":"none")}function Te(){D&&(D.style.display="none"),z&&(z.style.display="block"),M&&(M.style.display="inline-block")}function Y(){z&&(z.style.display="none"),M&&(M.style.display="none"),D&&(D.style.display="block")}async function Ne(){try{return await w.get()}catch{return null}}async function st(){if(!at()){Y(),L("App configuration missing. Set VITE_APPWRITE_ENDPOINT and VITE_APPWRITE_PROJECT_ID in .env and restart the dev server."),console.error("Missing env vars:",{ENDPOINT:ke,PROJECT_ID:tt});return}await Ne()?Te():Y()}async function Ie(t,e){try{return typeof w.createEmailPasswordSession=="function"?await w.createEmailPasswordSession({email:t,password:e}):await w.createEmailSession(t,e)}catch(i){try{return await w.createEmailPasswordSession(t,e)}catch{throw i}}}async function ct(t,e){try{if(typeof w.create=="function")try{return await w.create({userId:R.unique(),email:t,password:e})}catch{return await w.create(R.unique(),t,e)}throw new Error("Unsupported SDK version for registration")}catch(i){throw i}}async function rt(){try{typeof w.deleteSession=="function"?await w.deleteSession("current"):typeof w.deleteSessions=="function"&&await w.deleteSessions()}catch{}}H&&H.addEventListener("click",()=>{b=!b,P&&(P.textContent=b?"Create account":"Sign in"),H&&(H.textContent=b?"Have an account? Sign in":"Create account"),ge&&(ge.textContent=b?"Create a new account with email and password.":"Use your email and password to sign in."),L("")});we&&we.addEventListener("submit",async t=>{t.preventDefault();const e=(it?.value||"").trim(),i=(ot?.value||"").trim();if(!e||!i){L("Please enter your email and password.");return}ve(!0),L("");try{b?(await ct(e,i),await Ie(e,i)):await Ie(e,i),await Ne()?Te():L("Signed in, but no session detected. Check Appwrite Platform origin settings (CORS).")}catch(n){const o=n?.message||n?.response?.message||"Authentication failed";L(o),console.error("Auth error:",n)}finally{ve(!1)}});M&&M.addEventListener("click",async()=>{await rt(),Y()});st();
